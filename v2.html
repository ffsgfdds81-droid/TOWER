<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–•—Ä–æ–Ω–∏–∫–∏ –ë–∞—Å—Ç–∏–æ–Ω–∞: –í–æ–π–Ω–∞ –ó–∞ –†—É–±–µ–∂–∏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0a1931 0%, #185adb 100%);
            color: white;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        /* –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é */
        .menu-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0a1931 0%, #185adb 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 0.5s;
        }
        
        .menu-screen.hidden {
            display: none;
        }
        
        .menu-title {
            font-size: 4rem;
            color: #ffd700;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.7);
            margin-bottom: 40px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .menu-buttons {
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 300px;
        }
        
        .menu-btn {
            padding: 20px 40px;
            font-size: 1.5rem;
            background: linear-gradient(45deg, #ff416c, #ff4b2b);
            border: none;
            border-radius: 15px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .menu-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
            background: linear-gradient(45deg, #ff4b2b, #ff416c);
        }
        
        /* –≠–∫—Ä–∞–Ω –≤—ã–±–æ—Ä–∞ —É—Ä–æ–≤–Ω—è */
        .level-select-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0a1931 0%, #185adb 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 900;
            padding: 40px;
        }
        
        .level-select-screen.hidden {
            display: none;
        }
        
        .level-title {
            font-size: 3rem;
            color: #ffd700;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .levels-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 20px;
            max-width: 1000px;
            margin: 20px 0;
        }
        
        .level-btn {
            width: 120px;
            height: 120px;
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            background: linear-gradient(45deg, #00b4db, #0083b0);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .level-btn.completed {
            background: linear-gradient(45deg, #00b09b, #96c93d);
        }
        
        .level-btn.locked {
            background: linear-gradient(45deg, #8e9eab, #eef2f3);
            cursor: not-allowed;
            opacity: 0.5;
        }
        
        .level-btn:hover:not(.locked) {
            transform: scale(1.1);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }
        
        .level-name {
            font-size: 1rem;
            margin-top: 10px;
        }
        
        .back-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid white;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s;
        }
        
        .back-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(-5px);
        }
        
        /* –ò–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω */
        .game-screen {
            width: 100%;
            height: 100%;
            display: none;
        }
        
        .game-screen.active {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .game-header {
            width: 1200px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 0 0 20px 20px;
            margin-bottom: 20px;
        }
        
        .game-stats {
            display: flex;
            gap: 30px;
        }
        
        .stat {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .stat-value {
            font-size: 1.8rem;
            color: #ffd700;
            font-weight: bold;
        }
        
        .game-controls {
            display: flex;
            gap: 15px;
        }
        
        .game-btn {
            padding: 12px 24px;
            background: linear-gradient(45deg, #ff416c, #ff4b2b);
            border: none;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        .game-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .game-container {
            display: flex;
            gap: 30px;
        }
        
        .game-board {
            width: 800px;
            height: 600px;
            background: #0a1931;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            position: relative;
        }
        
        #gameCanvas {
            width: 100%;
            height: 100%;
            display: block;
        }
        
        .tower-panel {
            width: 300px;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        
        .tower-list {
            display: grid;
            /* 60 –±–∞—à–µ–Ω - 4 –∫–æ–ª–æ–Ω–∫–∏ */
            grid-template-columns: repeat(4, 1fr); 
            gap: 10px;
            margin-top: 20px;
        }
        
        .tower-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 5px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
            /* –£–º–µ–Ω—å—à–∞–µ–º —Ä–∞–∑–º–µ—Ä, —á—Ç–æ–±—ã –≤–º–µ—Å—Ç–∏—Ç—å –±–æ–ª—å—à–µ */
            height: 80px; 
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .tower-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-3px);
        }
        
        .tower-item.selected {
            border-color: #ffd700;
            background: rgba(255, 215, 0, 0.1);
        }
        
        .tower-icon {
            font-size: 1.5rem;
            margin-bottom: 3px;
        }
        
        .tower-name {
            font-size: 0.7rem;
            line-height: 1;
            margin-bottom: 2px;
        }
        
        .tower-cost {
            font-size: 0.8rem;
            color: #ffd700;
            font-weight: bold;
        }
        
        /* –≠–∫—Ä–∞–Ω –ø–æ–±–µ–¥—ã (–í—ã–∏–≥—Ä—ã—à) */
        .victory-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 800;
        }
        
        .victory-screen.active {
            display: flex;
        }
        
        .victory-title {
            /* –û–ë–ù–û–í–õ–ï–ù–û: –ù–∞–∑–≤–∞–Ω–∏–µ –º–µ–Ω—é –í—ã–∏–≥—Ä—ã—à–∞ */
            font-size: 5rem;
            color: #ffd700;
            margin-bottom: 30px;
            animation: victoryGlow 1.5s infinite alternate;
        }
        
        @keyframes victoryGlow {
            from { text-shadow: 0 0 20px #ffd700; }
            to { text-shadow: 0 0 40px #ffd700, 0 0 60px #ffd700; }
        }
        
        .victory-stats {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            min-width: 400px;
        }
        
        .victory-stat {
            text-align: center;
        }
        
        .victory-stat-value {
            font-size: 2rem;
            color: #ffd700;
            font-weight: bold;
        }
        
        /* –≠–∫—Ä–∞–Ω –ø–æ—Ä–∞–∂–µ–Ω–∏—è (–ü—Ä–æ–∏–≥—Ä—ã—à) */
        .defeat-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 800;
        }
        
        .defeat-screen.active {
            display: flex;
        }
        
        .defeat-title {
            /* –û–ë–ù–û–í–õ–ï–ù–û: –ù–∞–∑–≤–∞–Ω–∏–µ –º–µ–Ω—é –ü–æ—Ä–∞–∂–µ–Ω–∏—è */
            font-size: 5rem;
            color: #ff416c;
            margin-bottom: 30px;
            animation: defeatGlow 1.5s infinite alternate;
        }
        
        @keyframes defeatGlow {
            from { text-shadow: 0 0 20px #ff416c; }
            to { text-shadow: 0 0 40px #ff416c, 0 0 60px #ff416c; }
        }
        
        /* –í–æ–ª–Ω–æ–≤–æ–π —ç–∫—Ä–∞–Ω */
        .wave-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 700;
        }
        
        .wave-screen.active {
            display: flex;
        }
        
        .wave-title {
            font-size: 4rem;
            color: #00b4db;
            margin-bottom: 20px;
            animation: wavePulse 1s infinite;
        }
        
        @keyframes wavePulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .wave-enemies {
            font-size: 1.5rem;
            color: #ffd700;
            margin-bottom: 30px;
        }
        
        /* –ù–û–í–´–ô –°–¢–ò–õ–¨: –¢–∞–π–º–µ—Ä */
        .wave-timer {
            font-size: 2.5rem;
            color: #ffeb3b;
            margin-top: 20px;
            margin-bottom: 20px;
            font-weight: bold;
        }
        
        /* –ü–∞—É–∑–∞ */
        .pause-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 700;
        }
        
        .pause-screen.active {
            display: flex;
        }
        
        .pause-title {
            font-size: 4rem;
            color: #ffd700;
            margin-bottom: 40px;
        }
        
        .level-progress {
            margin: 20px 0;
            color: #ffd700;
            font-size: 1.2rem;
        }
    </style>
</head>
<body>
    <div class="menu-screen" id="menuScreen">
        <div class="menu-title">–•–†–û–ù–ò–ö–ò –ë–ê–°–¢–ò–û–ù–ê</div>
        <div class="menu-buttons">
            <button class="menu-btn" id="playBtn">–ò–ì–†–ê–¢–¨</button>
            <button class="menu-btn" id="continueBtn">–ü–†–û–î–û–õ–ñ–ò–¢–¨</button>
            <button class="menu-btn" id="helpBtn">–ü–†–ê–í–ò–õ–ê</button>
        </div>
    </div>
    
    <div class="level-select-screen hidden" id="levelSelectScreen">
        <button class="back-btn" id="backToMenuBtn">‚Üê –ù–∞–∑–∞–¥</button>
        <div class="level-title">–í–´–ë–ï–†–ò–¢–ï –£–†–û–í–ï–ù–¨</div>
        <div class="levels-grid" id="levelsGrid">
            </div>
    </div>
    
    <div class="game-screen" id="gameScreen">
        <div class="game-header">
            <div class="game-stats">
                <div class="stat">
                    <div>–£–†–û–í–ï–ù–¨</div>
                    <div id="currentLevel" class="stat-value">1</div>
                </div>
                <div class="stat">
                    <div>–í–û–õ–ù–ê</div>
                    <div id="currentWave" class="stat-value">1/20</div>
                </div>
                <div class="stat">
                    <div>–ó–î–û–†–û–í–¨–ï</div>
                    <div id="health" class="stat-value">100</div>
                </div>
                <div class="stat">
                    <div>–ó–û–õ–û–¢–û</div>
                    <div id="money" class="stat-value">500</div>
                </div>
                <div class="stat">
                    <div>–°–ß–Å–¢</div>
                    <div id="score" class="stat-value">0</div>
                </div>
            </div>
            <div class="game-controls">
                <button class="game-btn" id="pauseBtn">‚è∏ –ü–ê–£–ó–ê</button>
                <button class="game-btn" id="menuBtn">üè† –ú–ï–ù–Æ</button>
            </div>
        </div>
        
        <div class="game-container">
            <div class="game-board">
                <canvas id="gameCanvas" width="800" height="600"></canvas>
                
                <div class="wave-screen" id="waveScreen">
                    <div class="wave-title" id="waveTitle">–í–û–õ–ù–ê 1</div>
                    <div class="wave-enemies" id="waveEnemies">–ì–æ—Ç–æ–≤—å—Ç–µ—Å—å –∫ –∞—Ç–∞–∫–µ!</div>
                    <div class="wave-timer" id="deploymentTimer"></div> 
                    <button class="menu-btn" id="startWaveBtn">–ù–ê–ß–ê–¢–¨ –í–û–õ–ù–£</button>
                </div>
                
                <div class="pause-screen" id="pauseScreen">
                    <div class="pause-title">–ü–ê–£–ó–ê</div>
                    <div class="level-progress" id="levelProgress">–£—Ä–æ–≤–µ–Ω—å 1 ‚Ä¢ –í–æ–ª–Ω–∞ 1/20</div>
                    <div class="menu-buttons">
                        <button class="menu-btn" id="resumeBtn">–ü–†–û–î–û–õ–ñ–ò–¢–¨</button>
                        <button class="menu-btn" id="restartLevelBtn">–ó–ê–ù–û–í–û</button>
                        <button class="menu-btn" id="toMenuFromPauseBtn">–í –ú–ï–ù–Æ</button>
                    </div>
                </div>
            </div>
            
            <div class="tower-panel">
                <h3 style="color: #ffd700; text-align: center; margin-bottom: 20px;">–í–´–ë–û–† –ë–ê–®–ù–ò (60 –≤–∏–¥–æ–≤)</h3>
                <div class="tower-list" id="towerList">
                    </div>
                <div style="margin-top: 30px;">
                    <button class="game-btn" id="upgradeBtn" style="width: 100%; margin-bottom: 10px;">‚¨Ü –£–õ–£–ß–®–ò–¢–¨ (100üí∞)</button>
                    <button class="game-btn" id="sellBtn" style="width: 100%; background: linear-gradient(45deg, #8e44ad, #9b59b6);">üí∞ –ü–†–û–î–ê–¢–¨ (50%)</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="victory-screen" id="victoryScreen">
        <div class="victory-title">–ü–û–ë–ï–î–ê!</div>
        <div class="victory-stats">
            <div class="victory-stat">
                <div>–£—Ä–æ–≤–µ–Ω—å</div>
                <div id="victoryLevel" class="victory-stat-value">1</div>
            </div>
            <div class="victory-stat">
                <div>–í–æ–ª–Ω –ø—Ä–æ–π–¥–µ–Ω–æ</div>
                <div id="victoryWaves" class="victory-stat-value">20/20</div>
            </div>
            <div class="victory-stat">
                <div>–í—Ä–∞–≥–æ–≤ —É–±–∏—Ç–æ</div>
                <div id="victoryKills" class="victory-stat-value">0</div>
            </div>
            <div class="victory-stat">
                <div>–ó–æ–ª–æ—Ç–∞ –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–æ</div>
                <div id="victoryGold" class="victory-stat-value">0</div>
            </div>
        </div>
        <div class="menu-buttons">
            <button class="menu-btn" id="nextLevelBtn">–°–õ–ï–î–£–Æ–©–ò–ô –£–†–û–í–ï–ù–¨</button>
            <button class="menu-btn" id="toMenuFromVictoryBtn">–í –ú–ï–ù–Æ</button>
        </div>
    </div>
    
    <div class="defeat-screen" id="defeatScreen">
        <div class="defeat-title">–ü–û–†–ê–ñ–ï–ù–ò–ï</div>
        <div class="victory-stats">
            <div class="victory-stat">
                <div>–£—Ä–æ–≤–µ–Ω—å</div>
                <div id="defeatLevel" class="victory-stat-value">1</div>
            </div>
            <div class="victory-stat">
                <div>–í–æ–ª–Ω –ø—Ä–æ–π–¥–µ–Ω–æ</div>
                <div id="defeatWaves" class="victory-stat-value">0/20</div>
            </div>
            <div class="victory-stat">
                <div>–í—Ä–∞–≥–æ–≤ —É–±–∏—Ç–æ</div>
                <div id="defeatKills" class="victory-stat-value">0</div>
            </div>
            <div class="victory-stat">
                <div>–°—á—ë—Ç</div>
                <div id="defeatScore" class="victory-stat-value">0</div>
            </div>
        </div>
        <div class="menu-buttons">
            <button class="menu-btn" id="restartFromDefeatBtn">–ü–û–ü–†–û–ë–û–í–ê–¢–¨ –°–ù–û–í–ê</button>
            <button class="menu-btn" id="toMenuFromDefeatBtn">–í –ú–ï–ù–Æ</button>
        </div>
    </div>

    <script>
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const menuScreen = document.getElementById('menuScreen');
        const levelSelectScreen = document.getElementById('levelSelectScreen');
        const gameScreen = document.getElementById('gameScreen');
        const victoryScreen = document.getElementById('victoryScreen');
        const defeatScreen = document.getElementById('defeatScreen');
        const waveScreen = document.getElementById('waveScreen');
        const pauseScreen = document.getElementById('pauseScreen');
        const startWaveBtn = document.getElementById('startWaveBtn'); // –ü–æ–ª—É—á–∞–µ–º –∫–Ω–æ–ø–∫—É
        
        const playBtn = document.getElementById('playBtn');
        const continueBtn = document.getElementById('continueBtn');
        const backToMenuBtn = document.getElementById('backToMenuBtn');
        const levelsGrid = document.getElementById('levelsGrid');
        const towerList = document.getElementById('towerList');
        
        // –ò–≥—Ä–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let game = {
            currentLevel: 1,
            currentWave: 0,
            maxWaves: 20, // 20 –í–û–õ–ù
            health: 100,
            money: 500,
            score: 0,
            kills: 0,
            selectedTower: 'archer',
            towers: [],
            enemies: [],
            projectiles: [],
            effects: [],
            path: [],
            selectedTowerIndex: -1,
            waveInProgress: false,
            enemyCount: 0,
            maxEnemies: 0,
            gameRunning: false,
            gamePaused: false,
            completedLevels: JSON.parse(localStorage.getItem('tdCompletedLevels')) || [],
            waveStartTime: 0,
            // –ù–û–í–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï –î–õ–Ø –¢–ê–ô–ú–ï–†–ê
            deploymentTimeLimit: 60000, // 60 —Å–µ–∫—É–Ω–¥ (1 –º–∏–Ω—É—Ç–∞)
            deploymentEndTime: 0,
            deploymentInterval: null
        };
        
        // –£—Ä–æ–≤–Ω–∏ (20 —É—Ä–æ–≤–Ω–µ–π)
        const levels = [
            { name: "–ù–∞—á–∞–ª–æ –ø—É—Ç–∏", enemyHealth: 100, enemySpeed: 1, money: 500, health: 100 },
            { name: "–õ–µ—Å–Ω–∞—è —Ç—Ä–æ–ø–∞", enemyHealth: 120, enemySpeed: 1.1, money: 550, health: 100 },
            { name: "–ì–æ—Ä–Ω—ã–π –ø–µ—Ä–µ–≤–∞–ª", enemyHealth: 140, enemySpeed: 1.2, money: 600, health: 100 },
            { name: "–ü—É—Å—Ç—ã–Ω—è", enemyHealth: 160, enemySpeed: 1.1, money: 650, health: 100 },
            { name: "–ë–æ–ª–æ—Ç–∞", enemyHealth: 180, enemySpeed: 0.9, money: 700, health: 100 },
            { name: "–õ–µ–¥—è–Ω—ã–µ –ø–µ—â–µ—Ä—ã", enemyHealth: 200, enemySpeed: 1.3, money: 750, health: 100 },
            { name: "–í—É–ª–∫–∞–Ω", enemyHealth: 220, enemySpeed: 1.2, money: 800, health: 100 },
            { name: "–ü–æ–¥–∑–µ–º–µ–ª—å–µ", enemyHealth: 240, enemySpeed: 1.1, money: 850, health: 100 },
            { name: "–•—Ä–∞–º", enemyHealth: 260, enemySpeed: 1.2, money: 900, health: 100 },
            { name: "–ö—Ä–µ–ø–æ—Å—Ç—å", enemyHealth: 300, enemySpeed: 1, money: 1000, health: 100 },
            { name: "–ù–µ–±–µ—Å–Ω—ã–π –ø—É—Ç—å", enemyHealth: 320, enemySpeed: 1.4, money: 1100, health: 100 },
            { name: "–û–∫–µ–∞–Ω—Å–∫–∏–µ –≥–ª—É–±–∏–Ω—ã", enemyHealth: 340, enemySpeed: 0.8, money: 1200, health: 100 },
            { name: "–ö–æ—Å–º–∏—á–µ—Å–∫–∞—è —Å—Ç–∞–Ω—Ü–∏—è", enemyHealth: 360, enemySpeed: 1.3, money: 1300, health: 100 },
            { name: "–ò–∑–º–µ—Ä–µ–Ω–∏–µ —Ö–∞–æ—Å–∞", enemyHealth: 380, enemySpeed: 1.5, money: 1400, health: 100 },
            { name: "–¶–∏—Ç–∞–¥–µ–ª—å —Ç—å–º—ã", enemyHealth: 400, enemySpeed: 1.2, money: 1500, health: 100 },
            { name: "–õ–∞–±–∏—Ä–∏–Ω—Ç", enemyHealth: 450, enemySpeed: 1.1, money: 1600, health: 100 },
            { name: "–ê—Ä–µ–Ω–∞", enemyHealth: 500, enemySpeed: 1.3, money: 1700, health: 100 },
            { name: "–¢—Ä–æ–Ω–Ω—ã–π –∑–∞–ª", enemyHealth: 550, enemySpeed: 1.2, money: 1800, health: 100 },
            { name: "–í—Ä–∞—Ç–∞ –∞–¥–∞", enemyHealth: 600, enemySpeed: 1.4, money: 1900, health: 100 },
            { name: "–§–∏–Ω–∞–ª—å–Ω–æ–µ –∏—Å–ø—ã—Ç–∞–Ω–∏–µ", enemyHealth: 700, enemySpeed: 1.5, money: 2000, health: 100 }
        ];
        
        // –¢–∏–ø—ã –±–∞—à–µ–Ω (60 –≤–∏–¥–æ–≤) - (–û—Å—Ç–∞–≤–ª–µ–Ω—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
        const towerTypes = {
            archer: { name: '–õ—É—á–Ω–∏–∫', cost: 100, damage: 20, range: 150, speed: 800, color: '#4CAF50', icon: 'üèπ' },
            cannon: { name: '–ü—É—à–∫–∞', cost: 150, damage: 40, range: 120, speed: 1500, color: '#FF5722', icon: 'üí£' },
            mage: { name: '–ú–∞–≥', cost: 200, damage: 30, range: 140, speed: 1000, color: '#9C27B0', icon: 'üîÆ' },
            ice: { name: '–õ–µ–¥—è–Ω–∞—è', cost: 180, damage: 15, range: 130, speed: 900, color: '#03A9F4', icon: '‚ùÑÔ∏è' },
            laser: { name: '–õ–∞–∑–µ—Ä', cost: 250, damage: 10, range: 180, speed: 100, color: '#F44336', icon: 'üî¶' },
            poison: { name: '–Ø–¥', cost: 220, damage: 25, range: 140, speed: 1200, color: '#4CAF50', icon: '‚ò£Ô∏è' },
            tesla: { name: '–¢–µ—Å–ª–∞', cost: 300, damage: 15, range: 160, speed: 800, color: '#FFEB3B', icon: '‚ö°' },
            sonic: { name: '–°–æ–Ω–∏–∫', cost: 350, damage: 35, range: 100, speed: 500, color: '#2196F3', icon: 'üåÄ' },
            mario: { name: '–ú–∞—Ä–∏–æ', cost: 320, damage: 40, range: 90, speed: 2000, color: '#E91E63', icon: 'üë®‚Äçüîß' },
            ninja: { name: '–ù–∏–Ω–¥–∑—è', cost: 280, damage: 30, range: 80, speed: 400, color: '#000000', icon: 'ü•∑' },
            dragon: { name: '–î—Ä–∞–∫–æ–Ω', cost: 500, damage: 50, range: 170, speed: 2000, color: '#FF9800', icon: 'üêâ' },
            golem: { name: '–ì–æ–ª–µ–º', cost: 400, damage: 60, range: 110, speed: 2500, color: '#795548', icon: 'üóø' },
            necromancer: { name: '–ù–µ–∫—Ä–æ–º–∞–Ω—Ç', cost: 450, damage: 20, range: 150, speed: 3000, color: '#009688', icon: '‚ò†Ô∏è' },
            catapult: { name: '–ö–∞—Ç–∞–ø—É–ª—å—Ç–∞', cost: 380, damage: 45, range: 200, speed: 3000, color: '#8D6E63', icon: 'ü™®' },
            sniper: { name: '–°–Ω–∞–π–ø–µ—Ä', cost: 270, damage: 70, range: 250, speed: 2000, color: '#607D8B', icon: 'üéØ' },
            storm: { name: '–®—Ç–æ—Ä–º', cost: 330, damage: 25, range: 160, speed: 1800, color: '#3F51B5', icon: 'üå©Ô∏è' },
            vampire: { name: '–í–∞–º–ø–∏—Ä', cost: 290, damage: 35, range: 130, speed: 1400, color: '#D32F2F', icon: 'ü¶á' },
            portal: { name: '–ü–æ—Ä—Ç–∞–ª', cost: 420, damage: 0, range: 120, speed: 3000, color: '#7B1FA2', icon: 'üåÄ' },
            time: { name: '–í—Ä–µ–º—è', cost: 360, damage: 10, range: 150, speed: 2000, color: '#00BCD4', icon: '‚è±Ô∏è' },
            earthquake: { name: '–ó–µ–º–ª—è', cost: 480, damage: 60, range: 100, speed: 4000, color: '#8BC34A', icon: 'üåã' },
            spearman: { name: '–ö–æ–ø—å–µ–Ω–æ—Å–µ—Ü', cost: 110, damage: 15, range: 100, speed: 500, color: '#B7950B', icon: 'üî±' },
            flamethrower: { name: '–û–≥–Ω–µ–º–µ—Ç', cost: 240, damage: 5, range: 100, speed: 50, color: '#FF4500', icon: 'üî•' },
            shrapnel: { name: '–®—Ä–∞–ø–Ω–µ–ª—å', cost: 170, damage: 30, range: 160, speed: 2000, color: '#6C7A89', icon: 'üí•' },
            magnetic: { name: '–ú–∞–≥–Ω–∏—Ç', cost: 260, damage: 0, range: 180, speed: 1500, color: '#34495E', icon: 'üß≤' },
            alchemy: { name: '–ê–ª—Ö–∏–º–∏—è', cost: 310, damage: 20, range: 140, speed: 1100, color: '#F39C12', icon: 'üß™' },
            barricade: { name: '–ë–∞—Ä—Ä–∏–∫–∞–¥–∞', cost: 50, damage: 0, range: 0, speed: 0, color: '#A0522D', icon: 'üöß' },
            oracle: { name: '–û—Ä–∞–∫—É–ª', cost: 390, damage: 0, range: 300, speed: 5000, color: '#4B0082', icon: 'üëÅÔ∏è' },
            minigun: { name: '–ú–∏–Ω–∏–≥–∞–Ω', cost: 280, damage: 8, range: 120, speed: 80, color: '#696969', icon: 'üî´' },
            cryo: { name: '–ö—Ä–∏–æ-–ø—É—à–∫–∞', cost: 230, damage: 15, range: 150, speed: 1300, color: '#00FFFF', icon: 'ü•∂' },
            bounty: { name: '–û—Ö–æ—Ç–Ω–∏–∫', cost: 350, damage: 20, range: 170, speed: 1800, color: '#FFD700', icon: 'üí∞' },
            teleporter: { name: '–¢–µ–ª–µ–ø–æ—Ä—Ç', cost: 430, damage: 0, range: 100, speed: 5000, color: '#8A2BE2', icon: 'üåå' },
            poisonGas: { name: '–Ø–¥–æ–≤–∏—Ç—ã–π –ì–∞–∑', cost: 200, damage: 1, range: 110, speed: 50, color: '#90EE90', icon: 'üí®' },
            stoneThrower: { name: '–ö–∞–º–µ–Ω—â–∏–∫', cost: 130, damage: 50, range: 180, speed: 4000, color: '#A9A9A9', icon: 'ü™®' },
            spirit: { name: '–î—É—Ö', cost: 370, damage: 30, range: 140, speed: 1600, color: '#00FA9A', icon: 'üëª' },
            blackHole: { name: '–ß–µ—Ä–Ω–∞—è –î—ã—Ä–∞', cost: 550, damage: 100, range: 100, speed: 6000, color: '#000000', icon: '‚ö´' },
            artillery: { name: '–ê—Ä—Ç–∏–ª–ª–µ—Ä–∏—è', cost: 410, damage: 80, range: 400, speed: 3500, color: '#B8860B', icon: 'ü§Ø' },
            reflect: { name: '–û—Ç—Ä–∞–∂–∞—Ç–µ–ª—å', cost: 300, damage: 0, range: 130, speed: 1000, color: '#7FFFD4', icon: 'üõ°Ô∏è' },
            swarm: { name: '–†–æ–π', cost: 270, damage: 10, range: 110, speed: 100, color: '#556B2F', icon: 'üêù' },
            gravity: { name: '–ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è', cost: 460, damage: 5, range: 160, speed: 2000, color: '#4682B4', icon: '‚¨áÔ∏è' },
            steam: { name: '–ü–∞—Ä', cost: 190, damage: 20, range: 100, speed: 1000, color: '#DCDCDC', icon: '‚öôÔ∏è' },
            // –ù–æ–≤—ã–µ 20 –±–∞—à–µ–Ω (41-60)
            convert: { name: '–ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä', cost: 500, damage: 0, range: 100, speed: 8000, color: '#FF69B4', icon: 'üíñ' },
            bomb: { name: '–ë–æ–º–±–∞—Ä–¥–∏—Ä', cost: 350, damage: 90, range: 150, speed: 4500, color: '#556B2F', icon: 'üí•' },
            percent: { name: '–ü—Ä–æ—Ü–µ–Ω—Ç', cost: 420, damage: 5, range: 180, speed: 2000, color: '#00FF7F', icon: 'üìà' },
            freezer: { name: '–ì–ª—É–±–æ–∫–∞—è –ó–∞–º–æ—Ä–æ–∑–∫–∞', cost: 380, damage: 5, range: 140, speed: 5000, color: '#1E90FF', icon: 'üßä' },
            execute: { name: '–ü–∞–ª–∞—á', cost: 450, damage: 30, range: 160, speed: 1500, color: '#8B0000', icon: 'üó°Ô∏è' },
            slowField: { name: '–ü–æ–ª–µ –ó–∞–º–µ–¥–ª–µ–Ω–∏—è', cost: 210, damage: 0, range: 120, speed: 100, color: '#4682B4', icon: 'üêå' },
            pierce: { name: '–ü—Ä–æ–±–æ–π–Ω–∏–∫', cost: 300, damage: 35, range: 200, speed: 2000, color: '#9ACD32', icon: ' xuy√™n' },
            chain: { name: '–¶–µ–ø–Ω–∞—è –†–µ–∞–∫—Ü–∏—è', cost: 320, damage: 25, range: 170, speed: 1100, color: '#FFD700', icon: 'üîó' },
            buff: { name: '–ë–∞—Ñ—Ñ–µ—Ä', cost: 400, damage: 0, range: 100, speed: 5000, color: '#FF1493', icon: '‚ú®' },
            acid: { name: '–ö–∏—Å–ª–æ—Ç–Ω—ã–π –î–æ–∂–¥—å', cost: 390, damage: 10, range: 150, speed: 1500, color: '#7CFC00', icon: 'üíß' },
            chrono: { name: '–•—Ä–æ–Ω–æ—Å', cost: 520, damage: 1, range: 150, speed: 100, color: '#4B0082', icon: 'üï∞Ô∏è' },
            random: { name: '–†–∞–Ω–¥–æ–º', cost: 440, damage: 10, range: 140, speed: 1200, color: '#808080', icon: 'üé≤' },
            farShot: { name: '–î–∞–ª—å–Ω–æ–±–æ–π—â–∏–∫', cost: 280, damage: 10, range: 300, speed: 800, color: '#483D8B', icon: 'üî≠' },
            shockwave: { name: '–£–¥–∞—Ä–Ω–∞—è –í–æ–ª–Ω–∞', cost: 470, damage: 50, range: 110, speed: 3000, color: '#D2B48C', icon: '„Ä∞Ô∏è' },
            roadBlock: { name: '–ë–ª–æ–∫–∞–¥–∞', cost: 360, damage: 30, range: 0, speed: 2500, color: '#CD853F', icon: 'üõë' },
            summon: { name: '–ü—Ä–∏–∑—ã–≤–∞—Ç–µ–ª—å', cost: 550, damage: 0, range: 130, speed: 6000, color: '#FFA07A', icon: 'üêæ' },
            blind: { name: '–û—Å–ª–µ–ø–∏—Ç–µ–ª—å', cost: 410, damage: 0, range: 150, speed: 3500, color: '#FAFAD2', icon: 'üîÜ' },
            sacrificial: { name: '–ñ–µ—Ä—Ç–≤–µ–Ω–Ω—ã–π', cost: 370, damage: 5, range: 160, speed: 1000, color: '#C71585', icon: 'ü©∏' },
            debuffer: { name: '–î–µ–±–∞—Ñ—Ñ–µ—Ä', cost: 230, damage: 10, range: 140, speed: 1500, color: '#008B8B', icon: 'üîª' },
            ultimate: { name: '–£–ª—å—Ç–∏–º–∞—Ç—É–º', cost: 1000, damage: 200, range: 200, speed: 10000, color: '#FFD700', icon: 'üëë' } 
        };
        
        // –¢–∏–ø—ã –≤—Ä–∞–≥–æ–≤ (60 –≤–∏–¥–æ–≤) - (–û—Å—Ç–∞–≤–ª–µ–Ω—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
        const enemyTypes = [
            // –ë–∞–∑–æ–≤—ã–µ 40 –≤—Ä–∞–≥–æ–≤
            { name: 'üëπ –ì–æ–±–ª–∏–Ω', health: 100, speed: 1.2, color: '#70e000', money: 20 },
            { name: 'üßå –û—Ä–∫', health: 200, speed: 0.8, color: '#ff4800', money: 40 },
            { name: 'üíÄ –°–∫–µ–ª–µ—Ç', health: 150, speed: 1.0, color: '#f8f9fa', money: 30 },
            { name: 'üëª –ü—Ä–∏–∑—Ä–∞–∫', health: 120, speed: 1.4, color: '#c77dff', money: 35 },
            { name: 'ü¶Ö –ì–∞—Ä–ø–∏—è', health: 110, speed: 1.5, color: '#ff85a2', money: 45 },
            { name: 'üßü‚Äç‚ôÇÔ∏è –ó–æ–º–±–∏', health: 250, speed: 0.6, color: '#6a040f', money: 50 },
            { name: 'ü§ñ –†–æ–±–æ—Ç', health: 300, speed: 0.7, color: '#696969', money: 60 },
            { name: 'üëΩ –ò–Ω–æ–ø–ª–∞–Ω–µ—Ç—è–Ω–∏–Ω', health: 140, speed: 1.3, color: '#32cd32', money: 55 },
            { name: 'üßô‚Äç‚ôÄÔ∏è –ö–æ–ª–¥—É–Ω—å—è', health: 180, speed: 1.0, color: '#9370db', money: 65 },
            { name: 'üï∑Ô∏è –ü–∞—É–∫', health: 160, speed: 1.6, color: '#000000', money: 40 },
            { name: 'üßä –õ–µ–¥—è–Ω–æ–π –ì–æ–ª–µ–º', health: 400, speed: 0.5, color: '#38b000', money: 80 },
            { name: 'üî• –î–µ–º–æ–Ω', health: 320, speed: 0.9, color: '#ff0000', money: 75 },
            { name: 'üêô –ö—Ä–∞–∫–µ–Ω', health: 350, speed: 0.7, color: '#2e8b57', money: 85 },
            { name: 'üëÅÔ∏è –¶–∏–∫–ª–æ–ø', health: 280, speed: 0.8, color: '#ff4500', money: 70 },
            { name: 'üßõ –í–∞–º–ø–∏—Ä', health: 240, speed: 1.1, color: '#8b0000', money: 65 },
            { name: 'üó°Ô∏è –†—ã—Ü–∞—Ä—å', health: 260, speed: 0.9, color: '#3a0ca3', money: 75 },
            { name: '‚öîÔ∏è –°–∞–º—É—Ä–∞–π', health: 220, speed: 1.3, color: '#000080', money: 70 },
            { name: 'üß™ –ê–ª—Ö–∏–º–∏–∫', health: 190, speed: 1.0, color: '#f72585', money: 80 },
            { name: 'ü¶ñ –î–∏–Ω–æ–∑–∞–≤—Ä', health: 380, speed: 0.8, color: '#e63946', money: 90 },
            { name: 'üê≤ –î–†–ê–ö–û–ù', health: 500, speed: 0.5, color: '#ff0000', money: 200 },
            { name: 'üí® –í–æ–∑–¥—É—à–Ω—ã–π –®–∞—Ä', health: 100, speed: 2.0, color: '#ADD8E6', money: 45 },
            { name: 'üß± –ö–∞–º–µ–Ω–Ω—ã–π –°—Ç—Ä–∞–∂', health: 600, speed: 0.4, color: '#BDB76B', money: 120 },
            { name: 'üí° –ù–µ–∫—Å—É—Å', health: 150, speed: 1.1, color: '#F0E68C', money: 50 },
            { name: 'üê∏ –õ—è–≥—É—à–∫–∞', health: 130, speed: 0.9, color: '#228B22', money: 30 },
            { name: 'üõ°Ô∏è –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π', health: 350, speed: 0.7, color: '#C0C0C0', money: 70 },
            { name: 'üî™ –£–±–∏–π—Ü–∞', health: 180, speed: 1.8, color: '#101010', money: 60 },
            { name: 'üî• –§–µ–Ω–∏–∫—Å', health: 250, speed: 1.5, color: '#FF7F50', money: 80 },
            { name: 'üí£ –°–∞–º–æ—É–±–∏–π—Ü–∞', health: 100, speed: 1.3, color: '#B22222', money: 20 },
            { name: 'üí∏ –ú–∞—Ä–æ–¥–µ—Ä', health: 200, speed: 1.0, color: '#DAA520', money: 150 },
            { name: 'üåÄ –ò–ª–ª—é–∑–∏—è', health: 50, speed: 1.2, color: '#DDA0DD', money: 25 },
            { name: 'üêç –ú–µ–¥—É–∑–∞', health: 210, speed: 0.8, color: '#800080', money: 65 },
            { name: '‚ö° –≠–ª–µ–∫—Ç—Ä–∏–∫', health: 170, speed: 1.4, color: '#FFFF00', money: 70 },
            { name: 'üåä –í–æ–¥—è–Ω–æ–π', health: 230, speed: 1.0, color: '#4169E1', money: 75 },
            { name: 'ü™µ –õ–µ—Å–æ—Ä—É–±', health: 270, speed: 0.6, color: '#8B4513', money: 85 },
            { name: '‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º', health: 450, speed: 0.5, color: '#A9A9A9', money: 100 },
            { name: 'üçÑ –ì—Ä–∏–±', health: 160, speed: 1.1, color: '#808000', money: 50 },
            { name: 'üåà –°–ø–µ–∫—Ç—Ä', health: 10, speed: 1.7, color: '#FF1493', money: 25 },
            { name: 'üåô –¢–µ–Ω–µ–≤–æ–π –í–æ–ª–∫', health: 190, speed: 1.6, color: '#191970', money: 70 },
            { name: 'üåå –ê–Ω–æ–º–∞–ª–∏—è', health: 300, speed: 1.3, color: '#4B0082', money: 95 },
            { name: 'üëë –í–ï–†–•–û–í–ù–´–ô –î–†–ê–ö–û–ù', health: 1000, speed: 0.3, color: '#000000', money: 500 },
            // –ù–æ–≤—ã–µ 20 –≤—Ä–∞–≥–æ–≤ (41-60)
            { name: 'ü¶ü –†–æ–π –ú–æ—Å–∫–∏—Ç–æ–≤', health: 80, speed: 2.5, color: '#6B8E23', money: 30 }, 
            { name: 'üíé –ö—Ä–∏—Å—Ç–∞–ª–ª', health: 400, speed: 0.5, color: '#00CED1', money: 150 }, 
            { name: 'üöß –ò–Ω–∂–µ–Ω–µ—Ä', health: 220, speed: 0.7, color: '#B0C4DE', money: 60 }, 
            { name: 'ü¶† –ú—É—Ç–∞–Ω—Ç', health: 350, speed: 1.0, color: '#DAA520', money: 80 }, 
            { name: 'ü™∂ –ü—Ä–∏–∑—Ä–∞–∫ –ü–µ—Ä–∞', health: 130, speed: 1.8, color: '#FFE4B5', money: 55 }, 
            { name: '‚öôÔ∏è –ß–∞—Å–æ–≤–æ–π –ú–µ—Ö–∞–Ω–∏–∑–º', health: 480, speed: 0.6, color: '#778899', money: 110 }, 
            { name: 'üå™Ô∏è –≠–ª–µ–º–µ–Ω—Ç–∞–ª—å –í–µ—Ç—Ä–∞', health: 200, speed: 2.2, color: '#E0FFFF', money: 75 }, 
            { name: 'üî• –û–±–≥–æ—Ä–µ–≤—à–∏–π', health: 300, speed: 0.9, color: '#800000', money: 90 }, 
            { name: 'üê¢ –ß–µ—Ä–µ–ø–∞—Ö–∞', health: 550, speed: 0.2, color: '#2F4F4F', money: 130 }, 
            { name: 'üì° –†–µ–∑–æ–Ω–∞—Ç–æ—Ä', health: 260, speed: 1.1, color: '#8B008B', money: 85 }, 
            { name: 'üöÄ –†–∞–∫–µ—Ç–∞', health: 150, speed: 3.0, color: '#B22222', money: 70 }, 
            { name: 'üß™ –•–∏–º–∏–∫', health: 240, speed: 1.0, color: '#6A5ACD', money: 80 }, 
            { name: 'üå≤ –≠–Ω—Ç', health: 420, speed: 0.6, color: '#556B2F', money: 95 }, 
            { name: 'üåë –¢–µ–Ω—å', health: 190, speed: 1.4, color: '#2F4F4F', money: 65 }, 
            { name: 'üí• –Ø–¥—Ä–æ', health: 330, speed: 0.8, color: '#FFA500', money: 100 }, 
            { name: 'ü™± –ß–µ—Ä–≤—å', health: 210, speed: 0.7, color: '#CD853F', money: 75 }, 
            { name: 'üÉè –î–∂–æ–∫–µ—Ä', health: 10, speed: 1.5, color: '#FF4500', money: 50 }, 
            { name: 'üï∞Ô∏è –•—Ä–∞–Ω–∏—Ç–µ–ª—å –í—Ä–µ–º–µ–Ω–∏', health: 280, speed: 1.0, color: '#00BFFF', money: 90 }, 
            { name: 'üåå –ö–æ—Å–º–æ–Ω–∞–≤—Ç', health: 370, speed: 1.2, color: '#483D8B', money: 120 }, 
            { name: 'üëë –¢–ò–¢–ê–ù', health: 2000, speed: 0.1, color: '#FFD700', money: 1000 } 
        ];
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            // –°–æ–∑–¥–∞–µ–º —É—Ä–æ–≤–Ω–∏
            createLevels();
            
            // –°–æ–∑–¥–∞–µ–º –±–∞—à–Ω–∏ –≤ –ø–∞–Ω–µ–ª–∏
            createTowerButtons();
            
            // –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            setupEventListeners();
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ —É—Ä–æ–≤–Ω–µ–π, –∫–Ω–æ–ø–æ–∫ –±–∞—à–µ–Ω, –ø—É—Ç–∏ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
        function createLevels() { /* ... */ }
        function createTowerButtons() { /* ... */ }
        function createPathForLevel(level) { /* ... */ }
        
        // –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
        function updateDeploymentTimer() {
            const remainingTime = game.deploymentEndTime - Date.now();
            const timerElement = document.getElementById('deploymentTimer');
            
            if (remainingTime <= 0) {
                clearInterval(game.deploymentInterval);
                game.deploymentInterval = null;
                timerElement.textContent = "–í–†–ï–ú–Ø –ò–°–¢–ï–ö–õ–û! –ê–¢–ê–ö–ê!";
                startWave(); // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å—Ç–∞—Ä—Ç
            } else {
                const seconds = Math.floor(remainingTime / 1000);
                const ms = Math.floor((remainingTime % 1000) / 100);
                timerElement.textContent = `–û–°–¢–ê–õ–û–°–¨: ${seconds}.${ms} —Å`;
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —ç–∫—Ä–∞–Ω –≤–æ–ª–Ω—ã (–û–ë–ù–û–í–õ–ï–ù–û)
        function showWaveScreen() {
            waveScreen.classList.add('active');
            const waveTitle = document.getElementById('waveTitle');
            const waveEnemies = document.getElementById('waveEnemies');
            const timerElement = document.getElementById('deploymentTimer');
            
            // –û—á–∏—Å—Ç–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞, –µ—Å–ª–∏ –µ—Å—Ç—å
            if (game.deploymentInterval) clearInterval(game.deploymentInterval);
            
            if (game.currentWave === 0) {
                // –ü–ï–†–í–ê–Ø –í–û–õ–ù–ê –£–†–û–í–ù–Ø: –ù–µ—Ç —Ç–∞–π–º–µ—Ä–∞, —á—Ç–æ–±—ã –¥–∞—Ç—å –≤—Ä–µ–º—è –Ω–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É
                waveTitle.textContent = `–£–†–û–í–ï–ù–¨ ${game.currentLevel}`;
                waveEnemies.textContent = levels[game.currentLevel-1].name;
                timerElement.textContent = "–í–†–ï–ú–Ø –ù–ê –ü–û–î–ì–û–¢–û–í–ö–£ –ù–ï –û–ì–†–ê–ù–ò–ß–ï–ù–û";
                startWaveBtn.disabled = false;
            } else {
                // –ü–û–°–õ–ï–î–£–Æ–©–ò–ï –í–û–õ–ù–´: –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä
                const nextWave = game.currentWave + 1;
                waveTitle.textContent = `–í–û–õ–ù–ê ${nextWave}`;
                
                const enemiesInfo = [];
                if (nextWave % 5 === 0) {
                    enemiesInfo.push('–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –±–æ—Å—Å!');
                } else {
                    enemiesInfo.push(`${5 + Math.floor(nextWave/2)} –≤—Ä–∞–≥–æ–≤`);
                }
                
                waveEnemies.textContent = enemiesInfo.join(' ‚Ä¢ ');
                
                // –ù–∞—á–∏–Ω–∞–µ–º –æ–±—Ä–∞—Ç–Ω—ã–π –æ—Ç—Å—á–µ—Ç (60 —Å–µ–∫—É–Ω–¥)
                game.deploymentEndTime = Date.now() + game.deploymentTimeLimit;
                startWaveBtn.disabled = false;
                game.deploymentInterval = setInterval(updateDeploymentTimer, 100);
                updateDeploymentTimer(); // –ü–µ—Ä–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
            }
            
            game.waveStartTime = Date.now();
        }
        
        // –ù–∞—á–∞—Ç—å –≤–æ–ª–Ω—É (–û–ë–ù–û–í–õ–ï–ù–û)
        function startWave() {
            // –û—á–∏—â–∞–µ–º —Ç–∞–π–º–µ—Ä, –µ—Å–ª–∏ –≤–æ–ª–Ω–∞ –Ω–∞—á–∞–ª–∞—Å—å –≤—Ä—É—á–Ω—É—é –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏
            if (game.deploymentInterval) {
                clearInterval(game.deploymentInterval);
                game.deploymentInterval = null;
                document.getElementById('deploymentTimer').textContent = "";
            }
            
            waveScreen.classList.remove('active');
            game.currentWave++;
            document.getElementById('currentWave').textContent = `${game.currentWave}/${game.maxWaves}`;
            
            game.waveInProgress = true;
            game.enemyCount = 0;
            
            if (game.currentWave % 5 === 0) {
                game.maxEnemies = 1;
            } else {
                game.maxEnemies = 5 + Math.floor(game.currentWave / 2);
            }
            
            spawnEnemies();
        }
        
        // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (spawnEnemies, gameLoop, updateGame, updateEnemies, updateTowers, updateProjectiles, ...)
        // –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —Ç–µ—Ö, —á—Ç–æ —Å–≤—è–∑–∞–Ω—ã —Å –Ω–æ–≤—ã–º–∏ –±–∞—à–Ω—è–º–∏/–≤—Ä–∞–≥–∞–º–∏
        
        function updateEnemies() { /* ... */ }
        function updateTowers() { /* ... */ }
        function updateProjectiles() { /* ... */ }
        function updateEffects() { /* ... */ }
        function createExplosion(x, y, radius) { /* ... */ }
        function drawGame() { /* ... */ }
        function drawEnemies() { /* ... */ }
        function drawTowers() { /* ... */ }
        function drawBackground() { /* ... */ }
        function drawPath() { /* ... */ }
        function drawProjectiles() { /* ... */ }
        function drawEffects() { /* ... */ }
        function drawSelectedTower() { /* ... */ }
        function checkGameState() { /* ... */ }
        function victory() { /* ... */ }
        function defeat() { /* ... */ }
        function updateUI() { /* ... */ }
        
        // –ù–∞—á–∞–ª–æ —É—Ä–æ–≤–Ω—è (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
        function startLevel(level) { /* ... */ }
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
        function setupEventListeners() {
            playBtn.addEventListener('click', () => { menuScreen.classList.add('hidden'); levelSelectScreen.classList.remove('hidden'); createLevels(); }); // –î–æ–±–∞–≤–∏–ª createLevels –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞
            continueBtn.addEventListener('click', () => {
                if (game.completedLevels.length > 0) {
                    const lastLevel = Math.max(...game.completedLevels);
                    startLevel(lastLevel + 1 > 20 ? 20 : lastLevel + 1);
                } else {
                    startLevel(1);
                }
            });
            backToMenuBtn.addEventListener('click', () => { levelSelectScreen.classList.add('hidden'); menuScreen.classList.remove('hidden'); });
            
            document.getElementById('pauseBtn').addEventListener('click', () => {
                game.gamePaused = true;
                pauseScreen.classList.add('active');
                document.getElementById('levelProgress').textContent = 
                    `–£—Ä–æ–≤–µ–Ω—å ${game.currentLevel} ‚Ä¢ –í–æ–ª–Ω–∞ ${game.currentWave}/${game.maxWaves}`;
            });
            document.getElementById('menuBtn').addEventListener('click', () => {
                game.gameRunning = false;
                gameScreen.classList.remove('active');
                menuScreen.classList.remove('hidden');
                createLevels();
            });
            document.getElementById('resumeBtn').addEventListener('click', () => { game.gamePaused = false; pauseScreen.classList.remove('active'); });
            document.getElementById('restartLevelBtn').addEventListener('click', () => { pauseScreen.classList.remove('active'); startLevel(game.currentLevel); });
            document.getElementById('toMenuFromPauseBtn').addEventListener('click', () => { game.gameRunning = false; pauseScreen.classList.remove('active'); gameScreen.classList.remove('active'); menuScreen.classList.remove('hidden'); createLevels(); });
            startWaveBtn.addEventListener('click', startWave);
            document.getElementById('nextLevelBtn').addEventListener('click', () => {
                victoryScreen.classList.remove('active');
                if (game.currentLevel < 20) { startLevel(game.currentLevel + 1); } else { gameScreen.classList.remove('active'); menuScreen.classList.remove('hidden'); createLevels(); }
            });
            document.getElementById('toMenuFromVictoryBtn').addEventListener('click', () => { victoryScreen.classList.remove('active'); gameScreen.classList.remove('active'); menuScreen.classList.remove('hidden'); createLevels(); });
            document.getElementById('restartFromDefeatBtn').addEventListener('click', () => { defeatScreen.classList.remove('active'); startLevel(game.currentLevel); });
            document.getElementById('toMenuFromDefeatBtn').addEventListener('click', () => { defeatScreen.classList.remove('active'); gameScreen.classList.remove('active'); menuScreen.classList.remove('hidden'); createLevels(); });
            
            document.getElementById('upgradeBtn').addEventListener('click', () => {
                if (game.selectedTowerIndex >= 0 && game.money >= 100) {
                    const tower = game.towers[game.selectedTowerIndex];
                    tower.damage *= 1.5; tower.range *= 1.2; tower.level++; game.money -= 100; updateUI();
                }
            });
            document.getElementById('sellBtn').addEventListener('click', () => {
                if (game.selectedTowerIndex >= 0) {
                    const tower = game.towers[game.selectedTowerIndex];
                    const refund = Math.floor(towerTypes[tower.type].cost * 0.5);
                    game.money += refund;
                    game.towers.splice(game.selectedTowerIndex, 1);
                    game.selectedTowerIndex = -1;
                    updateUI();
                }
            });
            
            canvas.addEventListener('mousemove', (e) => {
                const rect = canvas.getBoundingClientRect();
                game.mouseX = e.clientX - rect.left;
                game.mouseY = e.clientY - rect.top;
            });
            
            canvas.addEventListener('click', (e) => {
                if (!game.gameRunning || game.gamePaused || game.waveInProgress) return;
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                for (let i = 0; i < game.towers.length; i++) {
                    const tower = game.towers[i];
                    const dx = x - tower.x;
                    const dy = y - tower.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    if (distance < 25) {
                        game.selectedTowerIndex = i;
                        document.querySelectorAll('.tower-item').forEach(item => { item.classList.remove('selected'); });
                        return;
                    }
                }
                
                game.selectedTowerIndex = -1; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ, –µ—Å–ª–∏ –∫–ª–∏–∫ –Ω–µ –ø–æ –±–∞—à–Ω–µ
                
                const type = towerTypes[game.selectedTower];
                if (game.money >= type.cost) {
                    let valid = true;
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É—Ç–∏
                    for (const point of game.path) {
                        const dx = x - point.x;
                        const dy = y - point.y;
                        if (Math.sqrt(dx * dx + dy * dy) < 60) { valid = false; break; }
                    }
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ –±–∞—à–Ω—è–º–∏
                    for (const tower of game.towers) {
                        const dx = x - tower.x;
                        const dy = y - tower.y;
                        if (Math.sqrt(dx * dx + dy * dy) < 50) { valid = false; break; }
                    }
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—Ü
                    if (x < 30 || x > canvas.width - 30 || y < 30 || y > canvas.height - 30) { valid = false; }
                    
                    if (valid) {
                        const tower = {
                            x: x, y: y, originalX: x, originalY: y, type: game.selectedTower,
                            damage: type.damage, range: type.range, speed: type.speed, color: type.color,
                            lastShot: 0, level: 1
                        };
                        game.towers.push(tower);
                        game.money -= type.cost;
                        game.selectedTowerIndex = game.towers.length - 1;
                        updateUI();
                    }
                }
            });
        }
        
        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            initGame();
        });
    </script>
</body>
</html>
